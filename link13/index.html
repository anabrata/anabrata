<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Candle Timer â€” Mobile Responsive</title>
  <style>
    :root{
      --digit-w: 120px;
      --digit-h: 170px;
      --digit-radius: 16px;
      --gap: clamp(24px, 5vw, 56px);
      --bg-angle: 135deg;
      --bg-c1: #3a1c71;
      --bg-c2: #d76d77;
      --bg-c3: #ffaf7b;
    }
    html,body{height:100%;}
    body{
      margin:0; display:flex; flex-direction:column; color:#111;
      font-family:"Comic Sans MS", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      background-image: linear-gradient(var(--bg-angle), var(--bg-c1), var(--bg-c2), var(--bg-c3));
      background-attachment: fixed; background-size: cover; background-position: center;
    }
    .brand{
      position:fixed; left:12px; top:10px; z-index:40; color:#fff;
      font-weight:800; font-size:13px; letter-spacing:.3px;
      text-shadow:0 1px 2px rgba(0,0,0,.35); user-select:none;
    }
    .main{
      flex:1;
      display:grid;
      grid-template-columns: max-content auto max-content;
      align-items:center;
      column-gap: var(--gap);
      padding:22px min(5vw,48px);
      position:relative;
      min-height: 60vh;
    }
    .main > section{ min-width:0; min-height:86px; }
    #timer-container{ grid-column:1; }
    #todo-panel     { grid-column:2; justify-self:center; align-self:center; }
    #candle-area    { grid-column:3; }
    #todo-panel{ display:none; }
    .todo-on #todo-panel{ display:block; }
    #timer-container, #candle-area, #todo-panel { min-height:86px; }

    /* Responsive mobile stacking & digit sizing */
    @media (max-width: 860px){
      .main{
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto;
        row-gap: var(--gap);
        align-items: center;
      }
      #timer-container{ grid-row:1; justify-self:center; width:100%; }
      #todo-panel{ grid-row:2; justify-self:center; }
      #candle-area{ grid-row:3; justify-self:center; }
      :root{
        --digit-w: clamp(72px, (100vw - 64px) / 6.8, 160px);
        --digit-h: calc(var(--digit-w) * 1.35);
      }
    }
    @media (max-width: 980px) and (orientation: landscape){
      :root{
        --digit-w: clamp(72px, (100vw - 80px) / 6.6, 180px);
        --digit-h: calc(var(--digit-w) * 1.35);
      }
    }

    /* Eye-catching bottom app bar and buttons */
    .appbar {
      position: fixed; left: 0; right: 0; bottom: 0; z-index: 120;
      display: flex; justify-content: space-around; align-items: center;
      padding: 12px 18px env(safe-area-inset-bottom, 18px);
      background: rgba(44,30,60,.60);
      backdrop-filter: blur(16px);
      border-top: 0.5px solid rgba(255,255,255,.18);
      box-shadow: 0 -2px 8px rgba(80,0,90,0.10);
    }
    .appbtn {
      appearance: none; border: none; outline: none;
      border-radius: 18px;
      padding: 14px 36px;
      font-size: 1.1em;
      font-weight: 900;
      letter-spacing: .03em;
      background: linear-gradient(120deg, #ff6b6b 0%, #ffd166 90%);
      color: #231028;
      box-shadow: 0 2px 10px rgba(180,130,250,0.22);
      transition: background 0.25s, color 0.13s, box-shadow .15s, transform .10s;
      cursor: pointer;
      opacity: 0.98;
    }
    .appbtn[aria-pressed="true"], .appbtn:active, .appbtn:focus-visible {
      background: linear-gradient(120deg, #ffd166 0%, #ff6b6b 100%);
      color: #fff;
      box-shadow: 0 0 14px 4px #ffd16688, 0 2px 12px #ff6b6bcc;
      transform: scale(1.04);
    }
    .appbtn:hover {
      background: linear-gradient(120deg, #fd415a 0%, #fae979 100%);
      color: #fff;
      box-shadow: 0 0 20px #ffd16655, 0 2px 12px #ff6b6ba0;
      transform: scale(1.06);
      opacity: 1;
    }
    .appbtn:active {
      transform: scale(0.98);
      box-shadow: 0 0 8px #ff6b6b77;
    }

    /* Overlays, sheets, and visibility */
    #controls {
      box-shadow: 0 -2px 32px #65007715, 0 8px 48px #ffddd300;
      background: rgba(48,24,54,.93);
      animation: sheetSlideIn .40s cubic-bezier(.25,1.1,.3,.95);
      position:fixed; left:0; right:0; bottom:0; z-index:130;
      height:min(68vh,560px); transform:translateY(102%);
      transition:transform .35s ease; border-top-left-radius:16px; border-top-right-radius:16px;
      overflow-y:auto; padding-bottom:calc(18px + env(safe-area-inset-bottom));
      min-height:220px;
    }
    body.settings-open #controls{ transform:translateY(0); }
    body.settings-open #appBar{ transform:translateY(130%); transition:transform .32s ease; }
    .sheetBar button {
      background: linear-gradient(90deg, #ffd166 0%, #ff6b6b 100%);
      color: #231028; font-weight:900;
      border:none; border-radius:16px; padding:8px 18px;
      box-shadow: 0 2px 10px #ffd166b8;
      cursor:pointer;
    }
    .sheetBar button:hover {
      background: linear-gradient(90deg, #fc7097 20%, #fae979 100%);
      color: #fff;
    }
    @keyframes sheetSlideIn { from { transform: translateY(110%);}
      to { transform: translateY(0); } }
    .is-fs .brand, .is-fs #controls, .is-fs .appbar{ display:none !important; }

    /* Prevent main from getting covered */
    .main{ padding-bottom:calc(64px + env(safe-area-inset-bottom)); }
  </style>
</head>
<body>
  <div class="brand">MADE BY ANABRATA â€” V10</div>
  <div class="main" id="main">
    <section id="timer-container" aria-label="Timer">
      <div id="timer"></div>
      <div id="simpleTimer">00:00</div>
    </section>
    <section id="todo-panel" class="todo-clear" aria-label="Toâ€‘do list">
      <h4 id="todoTitle">Toâ€‘do</h4>
      <ol id="todoList"></ol>
    </section>
    <section id="candle-area" aria-label="Candle">
      <div class="candle-clip">
        <div class="candle-wrap" id="candleWrap">
          <div class="wax" id="wax">
            <div class="waxTop"></div>
            <div class="wick" id="wick"></div>
          </div>
          <div class="stub" id="stub"></div>
        </div>
      </div>
      <div class="flame" id="flame"><div class="flame-core"></div></div>
    </section>
  </div>
  <!-- Controls (Settings) -->
  <div id="controls">
    <div class="sheetBar" role="toolbar" aria-label="Settings">
      <strong style="color:#fff">Settings</strong>
      <button id="closeSheet" class="btn small">Close</button>
    </div>
    <!-- ...settings cards are same as your original code... -->
  </div>
  <!-- Mobile app bar -->
  <div id="appBar" class="appbar" aria-label="App bar">
    <button id="timerTab" class="appbtn" aria-pressed="true">Timer</button>
    <button id="settingsBtn" class="appbtn">Settings</button>
  </div>
  <script>
    // JS: Ensures overlays don't hide main; re-adds interactive app bar and settings.
    function showTimerMain() {
      document.getElementById('timer-container').style.display = '';
      document.getElementById('candle-area').style.display = '';
      document.getElementById('todo-panel').style.display =
        document.body.classList.contains('todo-on') ? '' : 'none';
    }
    function openSettings(open){
      document.body.classList.toggle("settings-open", open);
      document.body.classList.toggle("no-scroll", open);
    }
    document.getElementById("settingsBtn").onclick = () => openSettings(true);
    document.getElementById("closeSheet").onclick = () => openSettings(false);
    document.getElementById("timerTab").onclick = () => {
      openSettings(false);
      showTimerMain();
    };
    document.addEventListener("fullscreenchange", () => {
      document.body.classList.toggle("is-fs", !!document.fullscreenElement);
      showTimerMain(); // Always restore sections after fs
      openSettings(false);
    });

    // Responsive digit sizing
    function computeDigitWidth() {
      const showH = document.getElementById("showHours")?.checked ?? false;
      const showS = document.getElementById("showSeconds")?.checked ?? true;
      const digits = (showH ? 2 : 0) + 2 + (showS ? 2 : 0);
      const colons = (showH ? 1 : 0) + (showS ? 1 : 0);
      const gapPx = 12, colonFactor = 0.33, sidePadding = 64;
      const maxW = Math.min(window.innerWidth, 1000) - sidePadding;
      const items = digits + colons, gaps = Math.max(0, items - 1);
      const denom = (digits + colons * colonFactor);
      let digitW = (maxW - gaps * gapPx) / Math.max(denom, 1);
      digitW = Math.max(72, Math.min(digitW, 180));
      document.documentElement.style.setProperty("--digit-w", `${digitW}px`);
      document.documentElement.style.setProperty("--digit-h", `${Math.round(digitW * 1.35)}px`);
    }
    ["showHours","showSeconds","useFlip"].forEach(id=>{
      document.getElementById(id)?.addEventListener("change", computeDigitWidth);
    });
    window.addEventListener("resize", computeDigitWidth);
    document.addEventListener("DOMContentLoaded", computeDigitWidth);

    // Overlay/finish visibility fix
    document.getElementById("cgClose")?.addEventListener("click", showTimerMain);
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>Candle Timer â€” Mobile Responsive</title>
<style>
  :root{
    /* Sizes */
    --digit-w: 120px;
    --digit-h: 170px;
    --digit-radius: 16px;
    --split-line: rgba(0,0,0,0.10);

    /* Spacing */
    --gap: clamp(24px, 5vw, 56px);

    /* Background gradient */
    --bg-angle: 135deg;
    --bg-c1: #3a1c71;
    --bg-c2: #d76d77;
    --bg-c3: #ffaf7b;

    /* Flip clock colors (with glass overlay) */
    --clock-c1: #ffffff;
    --clock-c2: #ffffff;
    --clock-c3: #ffffff;
    --clock-text: #000000;
    --colon-color: #ffffff;
    --clock-glass-bg: rgba(255,255,255,0.06);
    --clock-glass-border: rgba(255,255,255,0.18);

    /* Simple (nonâ€‘flip) clock color */
    --simple-color: #ffffff;

    /* Candle */
    --wax: #f2e4c7;
    --wick: #1b1b1b;

    /* Layout tweak */
    --candle-offset: 18px;

    /* Toâ€‘do base bg (transparent by default) */
    --todo-bg: transparent;
  }

  *{box-sizing:border-box}
  html,body{height:100%;}
  body{
    margin:0; display:flex; flex-direction:column; color:#111;
    font-family:"Comic Sans MS", system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    background-image: linear-gradient(var(--bg-angle), var(--bg-c1), var(--bg-c2), var(--bg-c3));
    background-attachment: fixed; background-size: cover; background-position: center;
  }

  .brand{
    position:fixed; left:12px; top:10px; z-index:40; color:#fff;
    font-weight:800; font-size:13px; letter-spacing:.3px;
    text-shadow:0 1px 2px rgba(0,0,0,.35); user-select:none;
  }

  .main{
    flex:1;
    display:grid;
    grid-template-columns: max-content auto max-content;
    align-items:center;
    column-gap: var(--gap);
    padding:22px min(5vw,48px);
    position:relative;
    min-height: 60vh;
  }
  .main > section{ min-width:0; min-height:0; }

  #timer-container{ grid-column:1; }
  #todo-panel     { grid-column:2; justify-self:center; align-self:center; }
  #candle-area    { grid-column:3; }

  /* Center Clock: timer centered; Toâ€‘do stays LEFT */
  .center-clock .main{ grid-template-columns: max-content 1fr max-content; }
  .center-clock #timer-container{
    position:absolute; left:50%; top:50%;
    transform:translate(-50%,-50%); z-index:5; min-width:0; width:auto;
  }
  .center-clock #todo-panel{
    position:static; grid-column:1; justify-self:start; align-self:center;
    margin-left:min(48px,5vw); z-index:6;
  }

  /* Hide candle â†’ Toâ€‘do occupies RIGHT */
  .candle-off #candle-area{ display:none !important; }
  .candle-off .main{ grid-template-columns: max-content max-content; }
  .candle-off #todo-panel{
    position:static !important; left:auto !important; top:auto !important; transform:none !important; justify-self:end !important;
  }

  /* Centerâ€‘clock + candleâ€‘off â†’ Toâ€‘do LEFT */
  .center-clock.candle-off .main{ grid-template-columns: max-content 1fr; }
  .center-clock.candle-off #todo-panel{
    position:static !important; grid-column:1 !important; justify-self:start !important;
    margin-left:min(48px,5vw) !important; z-index:6 !important;
  }

  /* Only candle â†’ center candle, hide clock; Toâ€‘do LEFT */
  .only-candle #timer-container{ display:none !important; }
  .only-candle .main{ grid-template-columns: max-content 1fr; }
  .only-candle #todo-panel{
    position:static; grid-column:1; justify-self:start; align-self:center; margin-left:min(48px,5vw);
    z-index:6;
  }
  .only-candle #candle-area{ grid-column: 2; justify-self: center; }

  /* Toâ€‘do visibility via .todo-on */
  #todo-panel{ display:none; }
  .todo-on #todo-panel{ display:block; }

  /* Toâ€‘do styling */
  #todo-panel{
    max-width: clamp(220px, 26vw, 420px);
    max-height: 60vh;
    font-size: 13px;
    overflow:auto; padding:10px 12px; border-radius:12px;
    border:1px solid rgba(255,255,255,.18);
    background: var(--todo-bg, transparent);
    box-shadow: 0 6px 18px rgba(0,0,0,.16), 0 2px 5px rgba(0,0,0,.1);
    color:#fff;
  }
  #todo-panel.todo-clear{ background: transparent !important; border-color: transparent !important; box-shadow: none !important; }
  #todo-panel.todo-glass{
    background: rgba(255,255,255,.06) !important;
    border:1px solid rgba(255,255,255,.12) !important;
    box-shadow: 0 8px 24px rgba(0,0,0,.18), 0 2px 6px rgba(0,0,0,.12) !important;
    backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
  }
  #todoTitle{ margin:0 0 6px 0; font-size:12.5px; font-weight:900; letter-spacing:.35px; opacity:.95; }
  #todoList{ margin:0; padding:4px 4px 4px 8px; list-style:none; counter-reset:tdn; font-family:inherit; }
  #todoList li{ counter-increment:tdn; position:relative; padding-left:28px; margin:4px 0; min-height:20px; outline:none; transition: opacity .18s, transform .18s; }
  #todoList li:before{ content: counter(tdn) "."; position:absolute; left:0; top:0; width:22px; text-align:right; padding-right:6px; font-weight:900; opacity:.9; }
  #todoList li.vanish{ opacity:0; transform:translateY(-3px); }
  .todoItem{ display:flex; align-items:center; gap:8px; }
  .todoChk{ appearance:none; width:16px; height:16px; border:2px solid rgba(255,255,255,.75); border-radius:4px; background:transparent; cursor:pointer; }
  .todoChk:checked{ background:#22c55e; border-color:#22c55e; }
  .todoChk:checked::after{ content:""; position:absolute; inset:0; background:linear-gradient(45deg,transparent 47%,#fff 47% 53%,transparent 53%),linear-gradient(-45deg,transparent 47%,#fff 47% 53%,transparent 53%); transform:scale(.48); }
  .todoText{ display:inline-block; min-width:36px; min-height:20px; padding:1px 5px; border-radius:6px; outline:none; color:#fff; caret-color:#fff; }
  .todoText:empty:before{ content:"New task"; opacity:.45; }

  /* Flip clock styles truncated for brevity (same as original code, including flip animation) */

  /* Simple clock */
  #simpleTimer{
    display:none; font-weight:900; letter-spacing:.04em; font-size:min(12vw,160px);
    color:var(--simple-color); text-shadow:0 0 10px rgba(0,0,0,.25), 0 12px 32px rgba(0,0,0,.25);
  }

  /* Candle styles truncated for brevity (same as original code) */

  /* Controls panel styles truncated for brevity (same as original code) */

  /* Fullscreen hide brand & controls */
  .is-fs .brand,
  .is-fs #controls,
  .is-fs .appbar{ display:none !important; }

  /* ===================== Mobile bottom app bar & bottom sheet ===================== */
  .appbar {
    position: fixed; left: 0; right: 0; bottom: 0; z-index: 120;
    display: flex; gap: 8px; justify-content: space-around; align-items: center;
    padding: 10px 12px calc(10px + env(safe-area-inset-bottom));
    background: rgba(0,0,0,.28); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
    border-top: 1px solid rgba(255,255,255,.14);
  }
  .appbtn {
    appearance: none; border: none; border-radius: 12px; padding: 10px 14px;
    font-weight: 800; cursor: pointer; font-family: inherit;
    background: rgba(255,255,255,.14); color: #fff;
  }
  .appbtn[aria-pressed="true"]{ background: rgba(255,255,255,.22); }
  .no-scroll{ overflow: hidden; }

  .sheetBar{
    display: flex; align-items: center; justify-content: space-between;
    gap: 10px; margin-bottom: 6px;
  }

  @media (max-width: 860px){
    /* Bottom sheet for controls */
    #controls {
      position: fixed; left: 0; right: 0; bottom: 0; z-index: 130;
      height: min(68vh, 560px);
      transform: translateY(102%);
      transition: transform .35s ease;
      border-top-left-radius: 16px; border-top-right-radius: 16px;
      overflow-y: auto; padding-bottom: calc(18px + env(safe-area-inset-bottom));
    }
    body.settings-open #controls{ transform: translateY(0); }
    body.settings-open #appBar{ transform: translateY(130%); transition: transform .32s ease; }

    /* Reserve space for bottom app bar */
    .main{ padding-bottom: calc(64px + env(safe-area-inset-bottom)); }

    /* Stack main areas */
    .main {
      grid-template-columns: 1fr;
      grid-template-rows: auto auto auto;
      row-gap: var(--gap);
      align-items: center;
    }
    #timer-container{ grid-row: 1; justify-self: center; width: 100%; }
    #todo-panel{ grid-row: 2; justify-self: center; }
    #candle-area{ grid-row: 3; justify-self: center; }

    /* Responsive digit sizing fallback */
    :root {
      --digit-w: clamp(72px, (100vw - 64px) / 6.8, 160px);
      --digit-h: calc(var(--digit-w) * 1.35);
    }
  }

  @media (max-width: 980px) and (orientation: landscape){
    :root {
      --digit-w: clamp(72px, (100vw - 80px) / 6.6, 180px);
      --digit-h: calc(var(--digit-w) * 1.35);
    }
  }

</style>
</head>
<body>
  <div class="brand">MADE BY ANABRATA â€” V10</div>

  <div class="main" id="main">
    <!-- Timer -->
    <section id="timer-container" aria-label="Timer">
      <div id="timer"></div>
      <div id="simpleTimer">00:00</div>
    </section>

    <!-- Toâ€‘do -->
    <section id="todo-panel" class="todo-clear" aria-label="Toâ€‘do list">
      <h4 id="todoTitle">Toâ€‘do</h4>
      <ol id="todoList"></ol>
    </section>

    <!-- Candle -->
    <section id="candle-area" aria-label="Candle">
      <div class="candle-clip">
        <div class="candle-wrap" id="candleWrap">
          <div class="wax" id="wax">
            <div class="waxTop"></div>
            <div class="wick" id="wick"></div>
          </div>
          <div class="stub" id="stub"></div>
        </div>
      </div>
      <div class="flame" id="flame"><div class="flame-core"></div></div>
    </section>
  </div>

  <!-- Controls (Settings) -->
  <div id="controls">
    <div class="sheetBar" role="toolbar" aria-label="Settings">
      <strong style="color:#fff">Settings</strong>
      <button id="closeSheet" class="btn small">Close</button>
    </div>

    <div class="card">
      <label class="small">Timer</label>
      <div class="row">
        <div style="flex:1"><label for="hoursInput">Hours</label><input id="hoursInput" type="number" min="0" value="0"></div>
        <div style="flex:1"><label for="minInput">Minutes</label><input id="minInput" type="number" min="0" value="1"></div>
        <div style="flex:1"><label for="secInput">Seconds</label><input id="secInput" type="number" min="0" max="59" value="0"></div>
      </div>
      <div class="row">
        <label><input type="checkbox" id="showHours"> Show hours</label>
        <label><input type="checkbox" id="showSeconds" checked> Show seconds</label>
        <label><input type="checkbox" id="useFlip" checked> Use flip style</label>
      </div>
      <div class="row">
        <button id="primaryBtn" class="btn wide">Start</button>
        <button id="resetBtn" class="btn alt wide">Reset</button>
        <button id="fsBtn" class="btn warn wide">Fullscreen</button>
      </div>
    </div>

    <div class="card">
      <label class="small">Background gradient</label>
      <div class="row">
        <div style="flex:1"><label for="bgAngle">Angle</label><input id="bgAngle" type="number" min="0" max="360" value="135"></div>
        <div style="flex:1"><label for="bgC1">Color 1</label><input id="bgC1" type="color" value="#3a1c71"></div>
        <div style="flex:1"><label for="bgC2">Color 2</label><input id="bgC2" type="color" value="#d76d77"></div>
        <div style="flex:1"><label for="bgC3">Color 3</label><input id="bgC3" type="color" value="#ffaf7b"></div>
      </div>
      <div class="row">
        <div style="flex:1; display:flex; gap:8px; align-items:center">
          <div style="flex:1">
            <label for="todoColor">Toâ€‘do list color</label>
            <input id="todoColor" type="color" value="#ffffff">
          </div>
          <button id="todoApply" class="btn small">Apply</button>
          <button id="todoClear" class="btn small" title="Transparent">Clear</button>
        </div>
      </div>
      <div class="row">
        <label><input type="checkbox" id="todoGlass"> Toâ€‘do transparency effect</label>
      </div>
    </div>

    <div class="card">
      <label class="small">Flip clock colors</label>
      <div class="row">
        <div style="flex:1"><label for="clockC1">Panel 1</label><input id="clockC1" type="color" value="#ffffff"></div>
        <div style="flex:1"><label for="clockC2">Panel 2</label><input id="clockC2" type="color" value="#ffffff"></div>
        <div style="flex:1"><label for="clockC3">Panel 3</label><input id="clockC3" type="color" value="#ffffff"></div>
      </div>
      <div class="row">
        <div style="flex:1"><label for="textColor">Digit color</label><input id="textColor" type="color" value="#000000"></div>
        <div style="flex:1"><label for="colonColor">Colon color</label><input id="colonColor" type="color" value="#ffffff"></div>
      </div>
      <div class="row">
        <label><input type="checkbox" id="clockTransparent"> Transparent flip cards</label>
      </div>
      <div class="row">
        <div style="flex:1"><label for="simpleColor">Simple timer color</label><input id="simpleColor" type="color" value="#ffffff"></div>
      </div>
    </div>

    <div class="card">
      <label class="small">Layout</label>
      <div class="row">
        <label><input type="checkbox" id="hideCandle"> Hide candle</label>
        <label><input type="checkbox" id="centerClock"> Center clock</label>
        <label><input type="checkbox" id="onlyCandle"> Only candle mode</label>
        <label><input type="checkbox" id="showTodo" checked> Show toâ€‘do list</label>
      </div>
    </div>
  </div>

  <!-- 3-2-1 overlay -->
  <div id="countOverlay" aria-hidden="true">
    <div id="countInner" class="pop">3</div>
  </div>

  <!-- Congrats overlay with balloons -->
  <div id="congrats" aria-modal="true" role="dialog">
    <div id="cgCard">
      <h2 id="cgTitle">Congratulations!</h2>
      <p id="cgMsg">Timer complete â€” great focus! ðŸŽ‰</p>
      <button id="cgClose">Close</button>
    </div>
    <div class="balloon" style="left:6%;  --bcol:#ff6b6b; --dur:9s;  --drift:12px"></div>
    <div class="balloon" style="left:14%; --bcol:#ffd166; --dur:8.5s;--drift:-10px"></div>
    <div class="balloon" style="left:22%; --bcol:#06d6a0; --dur:10s; --drift:8px"></div>
    <div class="balloon" style="left:30%; --bcol:#a78bfa; --dur:8.8s;--drift:-6px"></div>
    <div class="balloon" style="left:38%; --bcol:#f472b6; --dur:9.4s;--drift:16px"></div>
    <div class="balloon" style="left:46%; --bcol:#60a5fa; --dur:8.2s;--drift:-12px"></div>
    <div class="balloon" style="left:54%; --bcol:#f59e0b; --dur:9.8s;--drift:18px"></div>
    <div class="balloon" style="left:62%; --bcol:#34d399; --dur:8.6s;--drift:-14px"></div>
    <div class="balloon" style="left:70%; --bcol:#f87171; --dur:10.4s;--drift:10px"></div>
    <div class="balloon" style="left:78%; --bcol:#93c5fd; --dur:8.1s;--drift:-8px"></div>
    <div class="balloon" style="left:86%; --bcol:#f472b6; --dur:9.2s;--drift:14px"></div>
    <div class="balloon" style="left:94%; --bcol:#06d6a0; --dur:10.6s;--drift:-16px"></div>
  </div>

  <!-- Mobile app bar -->
  <div id="appBar" class="appbar" aria-label="App bar">
    <button id="timerTab" class="appbtn" aria-pressed="true">Timer</button>
    <button id="settingsBtn" class="appbtn">Settings</button>
  </div>

<script>
  const $ = (s) => document.querySelector(s);

  // All original JS logic from your file is here, including the flip clock functions,
  // timer countdown, candle animations, to-do list, background, controls, and fullscreen toggling.
  // For brevity, those are omitted here but should be included in full from your original script.

  // Responsive digit sizing function
  function computeDigitWidth() {
    const showH = $("#showHours")?.checked ?? false;
    const showS = $("#showSeconds")?.checked ?? true;
    const digits = (showH ? 2 : 0) + 2 + (showS ? 2 : 0);
    const colons = (showH ? 1 : 0) + (showS ? 1 : 0);
    const gapPx = 12;
    const colonFactor = 0.33;
    const sidePadding = 64;
    const maxW = Math.min(window.innerWidth, 1000) - sidePadding;
    const items = digits + colons;
    const gaps = Math.max(0, items - 1);
    const denom = (digits + colons * colonFactor);
    let digitW = (maxW - gaps * gapPx) / Math.max(denom, 1);
    digitW = Math.max(72, Math.min(digitW, 180));
    document.documentElement.style.setProperty("--digit-w", `${digitW}px`);
    document.documentElement.style.setProperty("--digit-h", `${Math.round(digitW * 1.35)}px`);
  }

  function hookDigitSizing(){
    ["showHours","showSeconds","useFlip"].forEach(id=>{
      document.getElementById(id)?.addEventListener("change", computeDigitWidth);
    });
    window.addEventListener("resize", computeDigitWidth);
    const _safeBuildClock = safeBuildClock;
    window.safeBuildClock = function(){
      _safeBuildClock();
      requestAnimationFrame(computeDigitWidth);
    };
  }

  // Mobile settings sheet toggle
  const settingsBtn = document.getElementById("settingsBtn");
  const closeSheet = document.getElementById("closeSheet");

  function openSettings(open){
    document.body.classList.toggle("settings-open", open);
    document.body.classList.toggle("no-scroll", open);
  }

  settingsBtn?.addEventListener("click", () => {
    const isOpen = document.body.classList.contains("settings-open");
    openSettings(!isOpen);
  });
  closeSheet?.addEventListener("click", () => openSettings(false));

  document.addEventListener("fullscreenchange", async () => {
    const isFs = !!document.fullscreenElement;
    document.body.classList.toggle("is-fs", isFs);
    if (isFs && screen.orientation?.lock) {
      try {
        await screen.orientation.lock("landscape");
      } catch (e) { }
    } else if (screen.orientation?.unlock) {
      try {
        screen.orientation.unlock();
      } catch (e) { }
    }
    if(isFs) openSettings(false);
  });

  // Your original boot function with hooks added
  (function boot(){
    // Original init functions and event listeners...

    hookDigitSizing();
    requestAnimationFrame(computeDigitWidth);

    // Other existing boot code...
  })();
</script>
</body>
</html>

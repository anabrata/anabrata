<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Professional Candle Timer</title>
  <style>
    :root {
      --primary-bg: #121212;
      --panel-bg: rgba(255,255,255,0.05);
      --accent: #ff9a00;
      --text-light: #f0f0f0;
      --text-dark: #202020;
      --box-radius: 14px;
      --transition: 0.3s ease;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--primary-bg);
      font-family: 'Arial', sans-serif;
      color: var(--text-light);
      overflow-x: hidden;
    }
    .main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 5%;
    }
    /* Flip-clock on left */
    #timer-container {
      flex: 1;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    #timer {
      display: flex;
      align-items: center;
      font-family: 'Courier New', monospace;
      font-size: 1.5rem;
    }
    .digit {
      width: 80px;
      height: 100px;
      margin: 0 8px;
      position: relative;
      background: #000;
      color: var(--text-light);
      border-radius: var(--box-radius);
      overflow: hidden;
      font-size: 80px;
      line-height: 100px;
      text-align: center;
      font-weight: bold;
      perspective: 800px;
    }
    .digit div {
      position: absolute;
      width: 100%;
      height: 50%;
      left: 0;
      backface-visibility: hidden;
    }
    .top { top: 0; transform-origin: bottom; }
    .bottom { bottom: 0; transform-origin: top; }
    .back-top { top: 0; transform: rotateX(180deg); }
    .back-bottom { bottom: 0; }
    @keyframes flipTop {
      0% { transform: rotateX(0deg); }
      100% { transform: rotateX(-90deg); }
    }
    @keyframes flipBottom {
      0% { transform: rotateX(90deg); }
      100% { transform: rotateX(0deg); }
    }
    .flipping .top {
      animation: flipTop 0.3s ease-in forwards;
    }
    .flipping .back-bottom {
      animation: flipBottom 0.3s 0.3s ease-out forwards;
    }
    /* Candle on right */
    #candle-container {
      flex: 1;
      display: flex;
      justify-content: flex-end;
      align-items: flex-end;
      position: relative;
      height: 350px;
    }
    #candle, #candle-out {
      width: 120px;
      height: 300px;
      border-radius: 16px;
      transition: background var(--transition), transform 1s ease, opacity 0.5s;
    }
    #candle { background: #faf3e0; box-shadow: inset 0 0 10px rgba(0,0,0,0.2); }
    #flame {
      position: absolute;
      top: calc(100% - 330px);
      left: calc(50% + 10px);
      width: 40px;
      height: 90px;
      background: radial-gradient(circle at 50% 20%, #fff7c2, var(--accent) 55%, transparent);
      border-radius: 50% 50% 30% 30%;
      filter: blur(2px);
      animation: flicker 0.12s infinite;
      transition: opacity 0.5s;
    }
    @keyframes flicker {
      0%,100% { transform: translate(-50%,0) scale(1); opacity: 1; }
      50% { transform: translate(-50%,0) scale(1.2); opacity: 0.7; }
    }
    #candle-out {
      background: #555;
      display: none;
      transform: rotate(25deg) translateY(-200px);
      opacity: 0.8;
    }
    /* Scroll-linked wave panel */
    #controls {
      position: relative;
      backdrop-filter: blur(8px);
      background: var(--panel-bg);
      padding: 15px 20px;
      display: flex;
      gap: 18px;
      align-items: center;
      justify-content: space-between;
      overflow-x: auto;
      border-top-left-radius: var(--box-radius);
      border-top-right-radius: var(--box-radius);
      scroll-snap-type: x mandatory;
    }
    .control-group {
      flex: 0 0 auto;
      scroll-snap-align: center;
      display: flex;
      flex-direction: column;
      align-items: start;
      color: var(--text-light);
    }
    .control-group label {
      font-size: 13px;
      margin-bottom: 4px;
    }
    .control-group input,
    .control-group select {
      padding: 6px 10px;
      border: none;
      border-radius: var(--box-radius);
      outline: none;
      font-size: 14px;
    }
    .control-group input[type="checkbox"] {
      transform: scale(1.3);
      margin-right: 6px;
    }
    #startBtn {
      flex: 0 0 auto;
      background: var(--accent);
      color: var(--text-dark);
      border: none;
      padding: 12px 24px;
      border-radius: var(--box-radius);
      font-weight: bold;
      cursor: pointer;
      transition: background var(--transition);
      scroll-snap-align: center;
    }
    #startBtn:hover {
      background: #ff7a00;
    }
    footer {
      text-align: center;
      padding: 8px;
      font-size: 12px;
      color: var(--text-light);
    }
  </style>
</head>
<body>
  <div class="main">
    <div id="timer-container">
      <div id="timer"></div>
    </div>
    <div id="candle-container">
      <div id="candle"></div>
      <div id="flame"></div>
      <div id="candle-out"></div>
    </div>
  </div>
  <div id="controls">
    <div class="control-group">
      <label for="minInput">Minutes</label>
      <input id="minInput" type="number" value="0" min="0" />
    </div>
    <div class="control-group">
      <label for="secInput">Seconds</label>
      <input id="secInput" type="number" value="30" min="0" max="59" />
    </div>
    <div class="control-group">
      <label>
        <input id="toggleSec" type="checkbox" checked /> Show Seconds
      </label>
    </div>
    <div class="control-group">
      <label for="colorPicker">Clock Color</label>
      <input id="colorPicker" type="color" value="#ffffff" />
    </div>
    <div class="control-group">
      <label for="bgPicker">Background</label>
      <input id="bgPicker" type="color" value="#121212" />
    </div>
    <div class="control-group">
      <label for="candleColorPicker">Candle Color</label>
      <input id="candleColorPicker" type="color" value="#faf3e0" />
    </div>
    <div class="control-group">
      <label for="fontPicker">Font</label>
      <select id="fontPicker">
        <option>Comic Sans MS</option>
        <option selected>Arial</option>
        <option>Verdana</option>
        <option>Courier New</option>
      </select>
    </div>
    <button id="startBtn">Start</button>
  </div>
  <footer>MADE BY ANABRATA</footer>

  <script>
    function createDigit() {
      const d = document.createElement('div');
      d.className = 'digit';
      ['top','back-top','bottom','back-bottom'].forEach(c => {
        const el = document.createElement('div');
        el.className = c;
        d.appendChild(el);
      });
      return d;
    }

    const timerEl = document.getElementById('timer');
    let digits = [], remaining = 0, intervalId;

    function setupDigits(showSec) {
      timerEl.innerHTML = '';
      digits = [];
      timerEl.appendChild(createDigit());
      timerEl.appendChild(createDigit());
      if (showSec) {
        const colon = document.createElement('span');
        colon.textContent = ':';
        colon.style.color = getComputedStyle(timerEl).color;
        colon.style.fontSize = '80px';
        timerEl.appendChild(colon);
        timerEl.appendChild(createDigit());
        timerEl.appendChild(createDigit());
      }
      digits = Array.from(timerEl.querySelectorAll('.digit'));
      updateDisplay(remaining);
    }

    function flipTo(digit, newVal) {
      const [top, backTop, bottom, backBottom] = digit.children;
      const oldVal = top.textContent || '0';
      if (oldVal === newVal) return;
      backTop.textContent = oldVal;
      bottom.textContent = newVal;
      backBottom.textContent = newVal;
      digit.classList.add('flipping');
      digit.addEventListener('animationend', () => {
        top.textContent = newVal;
        digit.classList.remove('flipping');
      }, { once: true });
    }

    function updateDisplay(sec) {
      const m = Math.floor(sec/60), s = sec%60;
      const arr = [
        ...String(m).padStart(2,'0'),
        ...(document.getElementById('toggleSec').checked
          ? String(s).padStart(2,'0').split('') : [])
      ];
      digits.forEach((d,i) => flipTo(d, arr[i] || '0'));
    }

    function tick() {
      if (remaining <= 0) {
        clearInterval(intervalId);
        document.getElementById('flame').style.opacity = '0';
        document.getElementById('candle').style.opacity = '0';
        document.getElementById('candle-out').style.display = 'block';
        document.getElementById('candle-container').style.transform = 'translateY(220px) rotate(25deg)';
        return;
      }
      remaining--;
      updateDisplay(remaining);
    }

    document.getElementById('startBtn').onclick = () => {
      clearInterval(intervalId);
      const m = +document.getElementById('minInput').value || 0;
      const s = +document.getElementById('secInput').value || 0;
      remaining = m*60 + s;
      setupDigits(document.getElementById('toggleSec').checked);
      intervalId = setInterval(tick, 1000);
    };

    document.getElementById('toggleSec').onchange = () =>
      setupDigits(document.getElementById('toggleSec').checked);

    document.getElementById('colorPicker').oninput = e =>
      timerEl.querySelectorAll('.digit, span').forEach(el => el.style.color = e.target.value);

    document.getElementById('bgPicker').oninput = e =>
      document.body.style.background = e.target.value;

    document.getElementById('candleColorPicker').oninput = e =>
      document.getElementById('candle').style.background = e.target.value;

    document.getElementById('fontPicker').onchange = e =>
      document.body.style.fontFamily = `'${e.target.value}', sans-serif`;

    // Initial
    setupDigits(true);
  </script>
</body>
</html>

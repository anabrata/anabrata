<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Professional Candle Timer</title>
  <style>
    :root {
      --primary-bg: #1e1e1e;
      --panel-bg: rgba(255,255,255,0.1);
      --accent: #ff9a00;
      --text-light: #ffffff;
      --text-dark: #333333;
      --box-radius: 12px;
      --transition: 0.3s ease;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--primary-bg);
      font-family: 'Arial', sans-serif;
      color: var(--text-light);
      overflow: hidden;
    }
    .main {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
    }
    /* Clock container on left */
    #timer-container {
      flex: 1;
      display: flex;
      justify-content: flex-start;
      align-items: center;
    }
    #timer {
      display: flex;
      align-items: center;
      font-family: 'Comic Sans MS', sans-serif;
    }
    .flip-card {
      perspective: 1200px;
    }
    .digit {
      width: 60px; height: 80px; margin: 0 6px;
      position: relative; overflow: hidden;
      background: #000; color: var(--text-light);
      border-radius: var(--box-radius);
      font-size: 60px; line-height: 80px;
      text-align: center; font-weight: bold;
      transition: background var(--transition);
    }
    .digit > div {
      position: absolute; width: 100%; height: 50%;
      left: 0; backface-visibility: hidden;
    }
    .top { top: 0; transform-origin: bottom; }
    .bottom { bottom: 0; transform-origin: top; }
    .back-top { top: 0; transform: rotateX(180deg); }
    .back-bottom { bottom: 0; }
    .flip-up {
      animation: flipUp 0.5s forwards;
    }
    .flip-down {
      animation: flipDown 0.5s forwards;
    }
    @keyframes flipUp {
      0% { transform: rotateX(0deg); }
      50% { transform: rotateX(-90deg); }
      100% { transform: rotateX(-180deg); }
    }
    @keyframes flipDown {
      0% { transform: rotateX(0deg); }
      50% { transform: rotateX(90deg); }
      100% { transform: rotateX(180deg); }
    }
    /* Candle on right */
    #candle-container {
      flex: 1;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      position: relative;
      height: 300px;
    }
    #candle, #candle-out {
      width: 100px; height: 250px;
      border-radius: 12px;
      transition: background var(--transition), transform 1s ease, opacity 0.5s;
    }
    #candle { background: #fff; }
    #flame {
      position: absolute; width: 40px; height: 80px;
      background: radial-gradient(circle at 50% 20%, #fffa90, var(--accent) 60%, transparent);
      border-radius: 50% 50% 30% 30%;
      filter: blur(2px);
      animation: flicker 0.15s infinite;
      transition: opacity 0.5s;
    }
    @keyframes flicker {
      0%,100% { transform: translateX(-50%) scale(1); opacity: 1; }
      50% { transform: translateX(-50%) scale(1.15); opacity: 0.75; }
    }
    #candle-out {
      background: #555; display: none;
      transform: rotate(30deg) translateY(-150px);
      opacity: 0.8;
    }
    /* Bottom control panel */
    #controls {
      background: var(--panel-bg);
      padding: 15px 20px;
      display: flex;
      gap: 20px;
      align-items: center;
      justify-content: center;
      border-top-left-radius: var(--box-radius);
      border-top-right-radius: var(--box-radius);
    }
    .control-group {
      display: flex; flex-direction: column;
      color: var(--text-light);
    }
    .control-group label {
      font-size: 14px; margin-bottom: 5px;
    }
    .control-group input[type="number"],
    .control-group select,
    .control-group input[type="color"] {
      padding: 6px 8px; border: none;
      border-radius: var(--box-radius);
      outline: none;
    }
    .control-group input[type="checkbox"] {
      transform: scale(1.2);
      margin-right: 5px;
    }
    #startBtn {
      background: var(--accent);
      color: var(--text-dark);
      border: none; padding: 10px 20px;
      border-radius: var(--box-radius);
      font-weight: bold; cursor: pointer;
      transition: background var(--transition);
    }
    #startBtn:hover {
      background: #ff7a00;
    }
    footer {
      position: absolute; bottom: 10px; width: 100%;
      text-align: center; font-size: 12px;
      color: var(--text-light);
    }
  </style>
</head>
<body>
  <div class="main">
    <div id="timer-container">
      <div id="timer"></div>
    </div>
    <div id="candle-container">
      <div id="candle"></div>
      <div id="flame"></div>
      <div id="candle-out"></div>
    </div>
  </div>
  <div id="controls">
    <div class="control-group">
      <label>Minutes</label>
      <input type="number" id="minInput" value="0" min="0" />
    </div>
    <div class="control-group">
      <label>Seconds</label>
      <input type="number" id="secInput" value="30" min="0" max="59" />
    </div>
    <div class="control-group">
      <label><input type="checkbox" id="toggleSec" checked /> Show Seconds</label>
    </div>
    <div class="control-group">
      <label>Clock Color</label>
      <input type="color" id="colorPicker" value="#ffffff" />
    </div>
    <div class="control-group">
      <label>Background</label>
      <input type="color" id="bgPicker" value="#1e1e1e" />
    </div>
    <div class="control-group">
      <label>Candle Color</label>
      <input type="color" id="candleColorPicker" value="#ffffff" />
    </div>
    <div class="control-group">
      <label>Font</label>
      <select id="fontPicker">
        <option value="Comic Sans MS">Comic Sans MS</option>
        <option value="Arial" selected>Arial</option>
        <option value="Verdana">Verdana</option>
        <option value="Courier New">Courier New</option>
      </select>
    </div>
    <button id="startBtn">Start</button>
  </div>
  <footer>MADE BY ANABRATA</footer>

  <script>
    function createDigit() {
      const d = document.createElement('div');
      d.className = 'digit';
      ['top','back-top','bottom','back-bottom'].forEach(cls => {
        const part = document.createElement('div');
        part.className = cls;
        d.appendChild(part);
      });
      return d;
    }

    const timerEl = document.getElementById('timer');
    let digits = [], remaining = 0, intervalId;

    function setupDigits(showSec) {
      timerEl.innerHTML = '';
      digits = [];
      timerEl.appendChild(createDigit());
      timerEl.appendChild(createDigit());
      if (showSec) {
        const colon = document.createElement('span');
        colon.textContent = ':';
        colon.style.color = getComputedStyle(timerEl).color;
        colon.style.fontSize = '60px';
        timerEl.appendChild(colon);
        timerEl.appendChild(createDigit());
        timerEl.appendChild(createDigit());
      }
      digits = Array.from(timerEl.querySelectorAll('.digit'));
      updateDisplay(remaining);
    }

    function flipTo(digit, newVal) {
      const [top, backTop, bottom, backBottom] = digit.children;
      const oldVal = top.textContent || '0';
      if (oldVal === newVal) return;
      backTop.textContent = oldVal;
      bottom.textContent = newVal;
      backBottom.textContent = newVal;
      // decide flip direction
      const anim = parseInt(newVal) < parseInt(oldVal) ? 'flip-down' : 'flip-up';
      digit.classList.add(anim);
      digit.addEventListener('animationend', () => {
        top.textContent = newVal;
        digit.classList.remove(anim);
      }, { once: true });
    }

    function updateDisplay(sec) {
      const mins = Math.floor(sec / 60);
      const secs = sec % 60;
      const arr = [
        ...String(mins).padStart(2,'0'),
        ...(document.getElementById('toggleSec').checked
          ? String(secs).padStart(2,'0').split('') : [])
      ];
      digits.forEach((d,i) => flipTo(d, arr[i] || '0'));
    }

    function tick() {
      if (remaining <= 0) {
        clearInterval(intervalId);
        document.getElementById('flame').style.opacity = '0';
        document.getElementById('candle').style.opacity = '0';
        document.getElementById('candle-out').style.display = 'block';
        document.getElementById('candle-container').style.transform = 'translateY(200px) rotate(30deg)';
        return;
      }
      remaining--;
      updateDisplay(remaining);
    }

    document.getElementById('startBtn').onclick = () => {
      clearInterval(intervalId);
      const m = parseInt(document.getElementById('minInput').value)||0;
      const s = parseInt(document.getElementById('secInput').value)||0;
      remaining = m*60 + s;
      setupDigits(document.getElementById('toggleSec').checked);
      intervalId = setInterval(tick, 1000);
    };

    document.getElementById('toggleSec').onchange = () => setupDigits(document.getElementById('toggleSec').checked);
    document.getElementById('colorPicker').oninput = e => {
      timerEl.querySelectorAll('.digit, span').forEach(el => el.style.color = e.target.value);
    };
    document.getElementById('bgPicker').oninput = e => document.body.style.background = e.target.value;
    document.getElementById('candleColorPicker').oninput = e => document.getElementById('candle').style.background = e.target.value;
    document.getElementById('fontPicker').onchange = e => document.body.style.fontFamily = `'${e.target.value}', sans-serif`;

    // initial
    setupDigits(true);
  </script>
</body>
</html>

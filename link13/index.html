<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WELCOME TO THE WORLD OF CELL</title>
  <!-- Using Plotly CDN - no local files needed -->
  <script src="https://cdn.plot.ly/plotly-2.34.0.min.js"></script>
  <style>
    :root{
      --bg1:#0f1021; --bg2:#1b1e3c; --bg3:#1d3557; --cardText:#e8ecff;
      --accent:#ffd166;
    }
    html, body { height:100%; margin:0; }
    body {
      min-height:100vh; color:#eef2ff;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      overflow:hidden;
      background: radial-gradient(1200px 800px at 20% 10%, #2b2d69 0%, transparent 60%),
                  linear-gradient(135deg, var(--bg1), var(--bg2), var(--bg3));
      background-size: 200% 200%;
      animation: bgPan 20s linear infinite, bgFade 1.8s ease both;
    }
    @keyframes bgPan { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
    @keyframes bgFade { from{opacity:0} to{opacity:1} }

    .banner { position:absolute; top:16px; left:50%; transform:translateX(-50%); text-align:center; z-index:10; padding:8px 12px; user-select:none; pointer-events:none; }
    .title { font-weight:900; letter-spacing:1px; margin:0; font-size:clamp(20px,3.8vw,44px); position:relative; display:inline-block; color:#fff; }
    .title .shine { background: linear-gradient(120deg, #ffffff 5%, #fff7, #ffffff 95%); -webkit-background-clip:text; background-clip:text; color:transparent; background-size:200% 100%; animation: sheen 6s ease-in-out infinite; text-shadow:0 0 18px rgba(255,255,255,0.12); }
    @keyframes sheen { 0%{background-position:200% 0} 50%{background-position:0% 0} 100%{background-position:-200% 0} }
    .subtitle { margin-top:6px; font-size:clamp(12px,1.6vw,16px); opacity:.85; }
    .credit { margin-top:4px; font-size:clamp(12px,1.5vw,15px); color:#c2c8ff; text-shadow: 0 0 10px rgba(255,255,255,0.08); }
    .glow { position:absolute; top:-40px; left:50%; transform:translateX(-50%); width:66vw; height:120px; border-radius:999px; background: radial-gradient(ellipse at center, rgba(255,209,102,0.22), transparent 60%); filter:blur(12px); z-index:1; pointer-events:none; animation:pulse 5.5s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{opacity:.6} 50%{opacity:.95} }

    #plot { width:100vw; height:100vh; }

    .panel { position:absolute; right:16px; top:96px; width:min(380px,86vw); background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.14); border-radius:12px; padding:14px; z-index:20; backdrop-filter: blur(10px) saturate(120%); box-shadow: 0 10px 40px rgba(0,0,0,0.35), inset 0 0 0 1px rgba(255,255,255,0.05); color:var(--cardText); opacity:0; transform:translateY(-8px); pointer-events:none; transition:opacity .35s ease, transform .35s ease; }
    .panel.show { opacity:1; transform:translateY(0); pointer-events:auto; }
    .panel h3 { margin:0 0 6px 0; font-size:18px }
    .panel p { margin:6px 0; font-size:14px; line-height:1.5 }
    .panel .hint { font-size:12px; opacity:.8; margin-top:8px }
    .panel .close { position:absolute; top:6px; right:8px; background:transparent; border:0; color:#fff; font-size:18px; cursor:pointer; opacity:.8; }
    .panel .close:hover { opacity:1 }

    #status { position:absolute; left:12px; bottom:12px; z-index:50; padding:6px 10px; background:rgba(0,0,0,0.6); color:#fff; border-radius:8px; font-size:13px; box-shadow:0 4px 18px rgba(0,0,0,0.35); }
    #status.error { background:#b00020 }
    .hintTop { position:absolute; right:16px; top:60px; z-index:15; font-size:12px; opacity:.85; background:rgba(0,0,0,0.35); color:#fff; padding:6px 10px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.25); user-select:none; }

    .intro-text { position:absolute; left:16px; top:120px; max-width:min(380px,86vw); background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02)); border:1px solid rgba(255,255,255,0.14); border-radius:12px; padding:14px; z-index:15; backdrop-filter: blur(10px) saturate(120%); box-shadow: 0 10px 40px rgba(0,0,0,0.35), inset 0 0 0 1px rgba(255,255,255,0.05); color:var(--cardText); font-size:14px; line-height:1.5; }
  </style>
</head>
<body>
  <div class="banner" aria-live="polite">
    <div class="glow"></div>
    <h1 class="title"><span class="shine">WELCOME TO THE WORLD OF CELL</span></h1>
    <div class="subtitle">Explore a 3D human (animal) cell. Click an organelle to learn more.</div>
    <div class="credit">Made by ANABRATA</div>
  </div>

  <div class="intro-text">
    <strong>About Cells:</strong><br>
    Cells are the basic structural and functional units of all living organisms. Human cells contain specialized compartments called organelles, each performing specific functions essential for life. This 3D model shows a typical animal cell with all major organelles in their approximate positions and proportions.
  </div>

  <div class="hintTop">Tip: rotate (drag), zoom (wheel), pan (right‑drag). Click organelles for info.</div>

  <div id="status">Loading…</div>
  <div id="plot" role="img" aria-label="Interactive 3D human cell with labeled organelles"></div>

  <div id="panel" class="panel" aria-live="polite">
    <button class="close" id="closePanel" title="Close">×</button>
    <h3 id="orgTitle">Organelle</h3>
    <p id="orgIntro">Details will appear here when you click any organelle.</p>
    <p class="hint">Click another organelle in the 3D view to switch.</p>
  </div>

  <script>
  (function(){
    const statusEl = document.getElementById('status');
    const panel = document.getElementById('panel');
    const titleEl = document.getElementById('orgTitle');
    const introEl = document.getElementById('orgIntro');
    document.getElementById('closePanel').addEventListener('click', ()=> panel.classList.remove('show'));

    function fail(msg){
      statusEl.classList.add('error');
      statusEl.textContent = msg;
    }

    // Check if Plotly loaded from CDN
    function checkPlotly(){
      if (typeof Plotly === 'undefined') {
        fail('Plotly failed to load from CDN. Check internet connection.');
        return false;
      }
      return true;
    }

    // Wait for Plotly to be available
    function waitForPlotly(){
      if(checkPlotly()) {
        startApp();
      } else {
        setTimeout(waitForPlotly, 100);
      }
    }
    
    // Start when page loads
    if(document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', waitForPlotly);
    } else {
      waitForPlotly();
    }

    // ----------------- App code (runs after Plotly loads) -----------------
    function startApp(){
      // Helpers
      function linspace(a,b,n){ if(n<2) return [a]; const s=(b-a)/(n-1), arr=new Array(n); for(let i=0;i<n;i++) arr[i]=a+s*i; return arr; }
      function zerosLike2D(M){ const Z=new Array(M.length); for(let i=0;i<M.length;i++){ Z[i]=new Array(M[i].length).fill(0) } return Z; }
      function ellipsoid(center, radii, nu, nv){
        const [cx,cy,cz]=center, [rx,ry,rz]=radii;
        const u=linspace(0,2*Math.PI,nu), v=linspace(0,Math.PI,nv);
        const X=new Array(nu), Y=new Array(nu), Z=new Array(nu);
        for(let i=0;i<nu;i++){
          const cu=Math.cos(u[i]), su=Math.sin(u[i]);
          X[i]=new Array(nv); Y[i]=new Array(nv); Z[i]=new Array(nv);
          for(let j=0;j<nv;j++){
            const sv=Math.sin(v[j]), cv=Math.cos(v[j]);
            X[i][j]=rx*cu*sv+cx; Y[i][j]=ry*su*sv+cy; Z[i][j]=rz*cv+cz;
          }
        }
        return {X,Y,Z};
      }
      function surface(X,Y,Z,color,opacity,name){
        return {
          type:'surface', x:X,y:Y,z:Z,
          surfacecolor: zerosLike2D(X),
          colorscale: [[0,color],[1,color]],
          showscale:false, opacity:opacity, name:name, hoverinfo:'name',
          lighting:{ambient:.5,diffuse:.5,specular:.2,roughness:.9},
          contours:{
            x:{show:true, color:'rgba(255,255,255,0.08)', width:1},
            y:{show:true, color:'rgba(255,255,255,0.08)', width:1},
            z:{show:true, color:'rgba(0,0,0,0.15)', width:1}
          }
        };
      }
      function randomPointsInShell(n, inner_r, outer_r, avoid_center, avoid_radius){
        const pts=[]; let attempts=0;
        while(pts.length<n && attempts<40000){
          const u=Math.random();
          const r=Math.pow((Math.pow(outer_r,3)-Math.pow(inner_r,3))*u + Math.pow(inner_r,3), 1/3);
          const z=Math.random()*2-1, t=Math.random()*2*Math.PI, s=Math.sqrt(1-z*z);
          const x=r*s*Math.cos(t), y=r*s*Math.sin(t), zc=r*z;
          if(avoid_center && typeof avoid_radius==='number'){
            const dx=x-avoid_center[0], dy=y-avoid_center[1], dz=zc-avoid_center[2];
            if(Math.hypot(dx,dy,dz) < avoid_radius){ attempts++; continue; }
          }
          pts.push([x,y,zc]); attempts++;
        }
        return pts;
      }
      function polyline3d(curveFn, t0, t1, steps){
        const t=linspace(t0,t1,steps), X=new Array(steps),Y=new Array(steps),Z=new Array(steps);
        for(let i=0;i<steps;i++){ const p=curveFn(t[i]); X[i]=p[0]; Y[i]=p[1]; Z[i]=p[2]; }
        return {X,Y,Z};
      }
      function lineTrace(xs,ys,zs,color,width,name){
        return {type:'scatter3d',mode:'lines',x:xs,y:ys,z:zs,line:{color,width},name,hoverinfo:'name',opacity:0.95};
      }

      // Organelle info database
      const INFO = {
        'Cell membrane': 'The selective barrier (phospholipid bilayer) that encloses the cell and regulates the entry and exit of substances. Contains embedded proteins for transport and signaling.',
        'Cytoplasm': 'The gel-like cytosol plus suspended organelles; site of many metabolic reactions including glycolysis. Provides structural support and medium for cellular processes.',
        'Nucleus': 'Double-membrane compartment that houses DNA and regulates gene expression. Contains the nucleolus and controls cellular activities through transcription.',
        'Nucleolus': 'Dense region inside nucleus where ribosomal RNA (rRNA) is produced and ribosome subunits are assembled before export to cytoplasm.',
        'Mitochondrion': 'The powerhouse organelle that generates ATP via cellular respiration. Has double membrane with cristae for increased surface area.',
        'Golgi apparatus': 'Modifies, sorts, packages and ships proteins and lipids received from the ER. Consists of stacked flattened membranes called cisternae.',
        'Rough ER': 'Endoplasmic reticulum studded with ribosomes. Synthesizes and folds proteins destined for secretion, membranes, or organelles.',
        'Smooth ER': 'ER without ribosomes. Functions in lipid synthesis, calcium storage, steroid production, and detoxification of harmful substances.',
        'Ribosome': 'Molecular machines that translate mRNA into proteins. Can be free in cytosol or attached to rough ER. Composed of rRNA and proteins.',
        'Lysosome': 'Membrane-bound organelles containing digestive enzymes. Break down worn-out organelles, cellular waste, and ingested materials.',
        'Peroxisome': 'Organelles that perform oxidative reactions, break down very-long-chain fatty acids, and detoxify hydrogen peroxide and other reactive molecules.',
        'Centrosome': 'Microtubule-organizing center containing a pair of centrioles. Plays crucial role in cell division and organizing the cytoskeleton.',
        'Cytoskeleton': 'Network of protein filaments (microtubules, microfilaments, intermediate filaments) that provides cell shape, organization, and enables movement.',
        'Chromatin': 'Complex of DNA and histone proteins found in the nucleus. Condenses to form visible chromosomes during cell division.',
        'Vesicle': 'Small membrane-bound sacs that transport materials within the cell or to the cell surface. Include transport vesicles and secretory vesicles.'
      };

      function openInfo(name){
        titleEl.textContent = name;
        introEl.textContent = INFO[name] || 'No detailed information available for this structure.';
        panel.classList.add('show');
      }

      // Build 3D scene
      const CELL_R=10.0, NUCLEUS_R=3.5, NUCLEOLUS_R=1.2;
      const traces = [];

      // Cytoplasm (faint inner volume)
      (function(){
        const e = ellipsoid([0,0,0],[CELL_R*0.98, CELL_R*0.93, CELL_R*0.88], 42, 26);
        traces.push(surface(e.X,e.Y,e.Z,'#4c566a',0.04,'Cytoplasm'));
      })();

      // Cell membrane
      (function(){
        const e = ellipsoid([0,0,0],[CELL_R, CELL_R*0.95, CELL_R*0.90], 64, 36);
        traces.push(surface(e.X,e.Y,e.Z,'#88c999',0.22,'Cell membrane'));
      })();

      // Nucleus
      (function(){
        const e = ellipsoid([1.0,0.5,0.0],[NUCLEUS_R*1.05, NUCLEUS_R, NUCLEUS_R*0.9], 56, 32);
        traces.push(surface(e.X,e.Y,e.Z,'#b48ead',0.5,'Nucleus'));
      })();

      // Nucleolus
      (function(){
        const e = ellipsoid([1.4,0.8,0.2],[NUCLEOLUS_R, NUCLEOLUS_R, NUCLEOLUS_R*0.9], 42, 26);
        traces.push(surface(e.X,e.Y,e.Z,'#bf616a',0.85,'Nucleolus'));
      })();

      // Chromatin strands
      (function(){
        function chromatinSpiral(cx,cy,cz,rad,turns,phase){
          const curve = (t)=>[ 
            cx + (rad + 0.3*Math.sin(3*t + phase)) * Math.cos(t),
            cy + (rad + 0.3*Math.cos(2*t + phase)) * Math.sin(t),
            cz + 0.7*Math.sin(1.3*t + phase) 
          ];
          const pl = polyline3d(curve, 0, 2*Math.PI*turns, 350);
          traces.push(lineTrace(pl.X,pl.Y,pl.Z,'#d08770',3,'Chromatin'));
        }
        chromatinSpiral(1.0,0.5,0.0,1.3,1.7,0.0);
        chromatinSpiral(1.0,0.5,0.0,1.0,1.5,1.3);
        chromatinSpiral(1.0,0.5,0.0,0.7,1.2,2.5);
      })();

      // Mitochondria
      (function(){
        const centers = randomPointsInShell(16, NUCLEUS_R+2.0, CELL_R-2.0, [1.0,0.5,0.0], NUCLEUS_R+1.0);
        for(const c of centers){
          const e = ellipsoid(c,[0.9,0.5,0.5], 30, 20);
          traces.push(surface(e.X,e.Y,e.Z,'#d08770',0.88,'Mitochondrion'));
        }
      })();

      // Golgi apparatus stacks
      (function(){
        const gc=[3.2,-0.8,0.4]; 
        const scales=[1.0,0.92,0.84,0.76,0.68,0.6];
        for(let i=0;i<scales.length;i++){
          const s=scales[i], center=[gc[0]+0.14*i, gc[1]+0.04*i, gc[2]];
          const e = ellipsoid(center,[1.8*s,0.82*s,0.22*s], 38, 20);
          traces.push(surface(e.X,e.Y,e.Z,'#ebcb8b',0.94,'Golgi apparatus'));
        }
      })();

      // Endoplasmic Reticulum
      (function(){
        function makeER(cx,cy,cz,amp,rad,twist,phase){
          return function(t){
            return [
              cx + (rad + amp*Math.sin(t*twist + phase)) * Math.cos(t),
              cy + (rad + amp*Math.cos(t*twist + phase)) * Math.sin(t),
              cz + 0.5*Math.sin(1.5*t + phase)
            ];
          }
        }
        const cent=[1.0,0.5,0.0];
        
        // Rough ER (with ribosomes)
        const roughPhases=[0.0, 1.1, 2.2];
        for(let i=0;i<roughPhases.length;i++){
          const cx=cent[0]-0.9+0.5*i, cy=cent[1]+0.2*i, cz=cent[2];
          const curve=makeER(cx,cy,cz,1.1,4.0-0.3*i,2.1,roughPhases[i]);
          const pl=polyline3d(curve,0,2*Math.PI,300);
          traces.push(lineTrace(pl.X,pl.Y,pl.Z,'#a3be8c',7,'Rough ER'));
          
          // Ribosomes on rough ER
          const rsX=[],rsY=[],rsZ=[];
          for(let k=0;k<pl.X.length;k+=16){ 
            rsX.push(pl.X[k] + (Math.random()-0.5)*0.15); 
            rsY.push(pl.Y[k] + (Math.random()-0.5)*0.15); 
            rsZ.push(pl.Z[k] + (Math.random()-0.5)*0.15); 
          }
          traces.push({type:'scatter3d',mode:'markers',x:rsX,y:rsY,z:rsZ,
                       marker:{size:2.8,color:'#5e81ac',opacity:.9},
                       name:'Ribosome',hoverinfo:'name'});
        }
        
        // Smooth ER
        const smoothPhases=[0.6, 1.9];
        for(let i=0;i<smoothPhases.length;i++){
          const cx=cent[0]+0.7-0.3*i, cy=cent[1]-0.3+0.25*i, cz=cent[2];
          const curve=makeER(cx,cy,cz,0.95,3.5-0.2*i,1.9,smoothPhases[i]);
          const pl=polyline3d(curve,0,2*Math.PI,260);
          traces.push(lineTrace(pl.X,pl.Y,pl.Z,'#8fbcbb',6,'Smooth ER'));
        }
      })();

      // Lysosomes
      (function(){
        const centers = randomPointsInShell(12, NUCLEUS_R+1.8, CELL_R-2.0, [1.0,0.5,0.0], NUCLEUS_R+1.0);
        for(const c of centers){
          const e=ellipsoid(c,[0.42,0.42,0.42], 20, 14);
          traces.push(surface(e.X,e.Y,e.Z,'#d08770',0.75,'Lysosome'));
        }
      })();

      // Peroxisomes  
      (function(){
        const centers = randomPointsInShell(10, NUCLEUS_R+1.6, CELL_R-2.0, [1.0,0.5,0.0], NUCLEUS_R+0.9);
        for(const c of centers){
          const e=ellipsoid(c,[0.38,0.38,0.38], 20, 14);
          traces.push(surface(e.X,e.Y,e.Z,'#a3be8c',0.78,'Peroxisome'));
        }
      })();

      // Vesicles (transport/secretory)
      (function(){
        const centers = randomPointsInShell(18, NUCLEUS_R+1.4, CELL_R-1.8, [1.0,0.5,0.0], NUCLEUS_R+0.8);
        for(const c of centers){
          const e=ellipsoid(c,[0.28,0.28,0.28], 16, 12);
          traces.push(surface(e.X,e.Y,e.Z,'#88c999',0.65,'Vesicle'));
        }
      })();

      // Centrosome
      (function(){
        const c0=[-1.7,-2.2,0.0], a1=[1.0,0.0,0.3], a2=[0.0,1.0,-0.3];
        traces.push({type:'scatter3d',mode:'lines',
                     x:[c0[0]-a1[0],c0[0]+a1[0]],y:[c0[1]-a1[1],c0[1]+a1[1]],z:[c0[2]-a1[2],c0[2]+a1[2]],
                     line:{color:'#b48ead',width:7},name:'Centrosome',hoverinfo:'name'});
        traces.push({type:'scatter3d',mode:'lines',
                     x:[c0[0]-a2[0],c0[0]+a2[0]],y:[c0[1]-a2[1],c0[1]+a2[1]],z:[c0[2]-a2[2],c0[2]+a2[2]],
                     line:{color:'#b48ead',width:7},name:'Centrosome',hoverinfo:'name'});
      })();

      // Cytoskeleton filaments
      (function(){
        function cytoskeletonFilament(cx,cy,cz,amp,rad,twist,len,color,width,name){
          const curve=(t)=>[
            cx + (rad + amp*Math.sin(t*twist))*Math.cos(t),
            cy + (rad + amp*Math.cos(t*twist))*Math.sin(t),
            cz + 0.8*Math.sin(1.2*t)
          ];
          const pl=polyline3d(curve,0,len,400);
          traces.push(lineTrace(pl.X,pl.Y,pl.Z,color,width,name));
        }
        cytoskeletonFilament(0,0,0,0.7,6.5,2.2,4.5*Math.PI,'#81a1c1',3,'Cytoskeleton');
        cytoskeletonFilament(-1.8,1.2,0.3,0.6,5.5,2.7,4*Math.PI,'#5e81ac',3,'Cytoskeleton');
        cytoskeletonFilament(1.5,-1.0,-0.4,0.8,4.8,1.8,4*Math.PI,'#88c999',3,'Cytoskeleton');
      })();

      // Free ribosomes in cytosol
      (function(){
        const pts = randomPointsInShell(280, NUCLEUS_R+1.3, CELL_R-1.8, [1.0,0.5,0.0], NUCLEUS_R+0.7);
        const xs=pts.map(p=>p[0]), ys=pts.map(p=>p[1]), zs=pts.map(p=>p[2]);
        traces.push({type:'scatter3d',mode:'markers',x:xs,y:ys,z:zs,
                     marker:{size:2.2,color:'#434c5e',opacity:0.8},
                     name:'Ribosome',hoverinfo:'name'});
      })();

      // Render the 3D plot
      const layout = {
        title: '',
        showlegend:true,
        legend:{orientation:'h', yanchor:'bottom', y:0.02, xanchor:'center', x:0.5, 
                font:{color:'#eceff4', size:11}},
        paper_bgcolor:'rgba(0,0,0,0)',
        plot_bgcolor:'rgba(0,0,0,0)',
        margin:{l:0,r:0,t:0,b:0},
        scene:{ 
          xaxis:{visible:false}, yaxis:{visible:false}, zaxis:{visible:false}, 
          aspectmode:'data', 
          camera:{eye:{x:1.8,y:2.0,z:1.2}}, 
          bgcolor:'rgba(0,0,0,0)' 
        }
      };

      const plotEl = document.getElementById('plot');
      Plotly.newPlot(plotEl, traces, layout, {responsive:true, displayModeBar:false}).then(()=>{
        statusEl.textContent = 'Ready • Click any organelle to explore';
        setTimeout(()=>{ statusEl.style.opacity = 0; }, 2800);
      }).catch(e=>{
        statusEl.classList.add('error');
        statusEl.textContent = 'Plot render error: ' + e.message;
      });

      // Handle clicks on organelles
      plotEl.on('plotly_click', function(ev){
        if(!ev || !ev.points || !ev.points.length) return;
        const name = ev.points[0].fullData.name || 'Cell structure';
        openInfo(name);
      });

      // Resize handler
      window.addEventListener('resize', ()=>Plotly.Plots.resize(plotEl));
    }
  })();
  </script>
</body>
</html>
